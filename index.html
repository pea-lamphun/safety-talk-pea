<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Safety Talk - PEA Lamphun</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body>
  <div id="root"></div>
  
  <script type="module">
    // Import React และ ReactDOM
    import React from 'https://esm.sh/react@18.2.0'
    import ReactDOM from 'https://esm.sh/react-dom@18.2.0'
    import * as LucideReact from 'https://esm.sh/lucide-react@0.263.1'
    
    // โหลดโค้ดจากไฟล์ jsx
    const loadApp = async () => {
      try {
        const response = await fetch('./safety-talk-firebase.jsx')
        const code = await response.text()
        
        // สร้าง module และรันโค้ด
        const exports = {}
        const module = { exports }
        
        // สร้าง function wrapper
        const func = new Function(
          'module', 'exports', 'React', 'useState', 'useEffect', 'useRef',
          'Camera', 'MapPin', 'Clock', 'Users', 'CheckCircle', 'XCircle', 
          'Calendar', 'TrendingUp', 'AlertCircle', 'Settings', 'QrCode', 
          'Download', 'Upload', 'UserPlus', 'Edit2', 'Trash2', 'Search', 
          'FileText', 'BarChart3', 'Filter',
          code
        )
        
        // รัน function
        func(
          module, exports, React, React.useState, React.useEffect, React.useRef,
          LucideReact.Camera, LucideReact.MapPin, LucideReact.Clock, 
          LucideReact.Users, LucideReact.CheckCircle, LucideReact.XCircle,
          LucideReact.Calendar, LucideReact.TrendingUp, LucideReact.AlertCircle,
          LucideReact.Settings, LucideReact.QrCode, LucideReact.Download,
          LucideReact.Upload, LucideReact.UserPlus, LucideReact.Edit2,
          LucideReact.Trash2, LucideReact.Search, LucideReact.FileText,
          LucideReact.BarChart3, LucideReact.Filter
        )
        
        // Render แอพ
        const App = module.exports.default || exports.default
        ReactDOM.createRoot(document.getElementById('root')).render(
          React.createElement(App)
        )
      } catch (error) {
        console.error('Error loading app:', error)
        document.getElementById('root').innerHTML = `
          <div style="padding: 20px; color: red;">
            <h2>ไม่สามารถโหลดแอพได้</h2>
            <p>กรุณาตรวจสอบว่าไฟล์ safety-talk-firebase.jsx อยู่ในโฟลเดอร์เดียวกัน</p>
            <p>Error: ${error.message}</p>
          </div>
        `
      }
    }
    
    loadApp()
  </script>
</body>
</html>